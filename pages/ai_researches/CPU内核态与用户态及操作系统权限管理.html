<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CPU内核态与用户态及操作系统权限管理</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            background: linear-gradient(135deg, #1a237e 0%, #283593 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .subtitle {
            text-align: center;
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }
        
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .sidebar {
            flex: 1;
            min-width: 250px;
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            height: fit-content;
        }
        
        .content {
            flex: 3;
            min-width: 300px;
        }
        
        h2 {
            color: #1a237e;
            border-bottom: 2px solid #3949ab;
            padding-bottom: 8px;
            margin: 25px 0 15px 0;
            font-size: 1.8rem;
        }
        
        h3 {
            color: #283593;
            margin: 20px 0 10px 0;
            font-size: 1.4rem;
        }
        
        h4 {
            color: #3949ab;
            margin: 15px 0 8px 0;
            font-size: 1.2rem;
        }
        
        .section {
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }
        
        .section:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
        }
        
        p {
            margin-bottom: 15px;
            text-align: justify;
        }
        
        ul, ol {
            margin: 15px 0 15px 25px;
        }
        
        li {
            margin-bottom: 8px;
        }
        
        .definition-box {
            background-color: #e8eaf6;
            border-left: 4px solid #3949ab;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .comparison-table th {
            background-color: #3949ab;
            color: white;
            padding: 12px;
            text-align: left;
        }
        
        .comparison-table td {
            padding: 12px;
            border: 1px solid #ddd;
        }
        
        .comparison-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .comparison-table tr:hover {
            background-color: #f1f3ff;
        }
        
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9rem;
            white-space: pre-wrap;
            overflow-x: auto;
        }
        
        .highlight {
            background-color: #fff8e1;
            padding: 3px 6px;
            border-radius: 3px;
            font-weight: 600;
        }
        
        .architecture-diagram {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 25px 0;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        
        .ring-levels {
            display: flex;
            justify-content: center;
            width: 100%;
            margin: 20px 0;
        }
        
        .ring {
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            margin: 0 10px;
            color: white;
            font-weight: bold;
        }
        
        .ring-0 {
            width: 120px;
            height: 120px;
            background-color: #d32f2f;
        }
        
        .ring-1 {
            width: 160px;
            height: 160px;
            background-color: #f57c00;
        }
        
        .ring-2 {
            width: 200px;
            height: 200px;
            background-color: #388e3c;
        }
        
        .ring-3 {
            width: 240px;
            height: 240px;
            background-color: #1976d2;
        }
        
        .permission-levels {
            display: flex;
            justify-content: space-around;
            width: 100%;
            margin-top: 30px;
        }
        
        .permission-level {
            flex: 1;
            padding: 15px;
            margin: 0 10px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        }
        
        .kernel-mode {
            background-color: #e8f5e9;
            border: 2px solid #388e3c;
        }
        
        .user-mode {
            background-color: #e3f2fd;
            border: 2px solid #1976d2;
        }
        
        .nav-list {
            list-style-type: none;
            margin: 0;
            padding: 0;
        }
        
        .nav-list li {
            margin-bottom: 10px;
        }
        
        .nav-list a {
            display: block;
            padding: 12px 15px;
            background-color: #f5f5f5;
            border-radius: 6px;
            color: #333;
            text-decoration: none;
            transition: all 0.3s ease;
        }
        
        .nav-list a:hover {
            background-color: #e8eaf6;
            color: #1a237e;
            transform: translateX(5px);
        }
        
        .nav-list .active {
            background-color: #3949ab;
            color: white;
        }
        
        .summary-box {
            background-color: #e8eaf6;
            border-radius: 8px;
            padding: 20px;
            margin: 25px 0;
            border-left: 5px solid #3949ab;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            color: #666;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .ring-levels {
                flex-direction: column;
                align-items: center;
            }
            
            .ring {
                margin: 10px 0;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>CPU内核态与用户态及操作系统权限管理</h1>
        <p class="subtitle">深入理解操作系统安全架构与权限控制机制</p>
    </header>
    
    <div class="container">
        <aside class="sidebar">
            <h3>导航目录</h3>
            <ul class="nav-list">
                <li><a href="#section1" class="active">1. CPU内核态与用户态基础概念</a></li>
                <li><a href="#section2">2. 操作系统权限管理体系</a></li>
                <li><a href="#section3">3. 用户权限管理</a></li>
                <li><a href="#section4">4. 实际应用与案例分析</a></li>
                <li><a href="#section5">5. 总结与展望</a></li>
            </ul>
            
            <div class="summary-box">
                <h4>核心要点</h4>
                <ul>
                    <li>内核态运行在最高特权级别，具有完全系统访问权限</li>
                    <li>用户态运行在最低特权级别，权限受到严格限制</li>
                    <li>权限管理遵循最小权限原则</li>
                    <li>系统调用是用户态到内核态切换的主要方式</li>
                </ul>
            </div>
        </aside>
        
        <main class="content">
            <section id="section1" class="section">
                <h2>1. CPU内核态与用户态基础概念</h2>
                
                <h3>1.1 内核态与用户态的定义与本质</h3>
                <div class="definition-box">
                    <p><strong>内核态（Kernel Mode）</strong>：操作系统内核所运行的模式，运行在最高特权级别。CPU可以执行任何指令，访问所有内存和硬件设备。</p>
                    <p><strong>用户态（User Mode）</strong>：应用程序运行的模式，运行在最低特权级别。CPU只能执行受限的指令集，不允许直接访问硬件或操作内核数据。</p>
                </div>
                
                <p>内核态与用户态是现代操作系统为了保护系统核心资源、保证系统稳定性而采用的一种CPU运行级别或权限模式。这两种状态构成了操作系统安全架构的基础，通过硬件层面的特权级保护机制实现对系统资源的严格管控。</p>
                
                <div class="architecture-diagram">
                    <h4>CPU特权级架构 (以x86为例)</h4>
                    <div class="ring-levels">
                        <div class="ring ring-0">Ring 0<br>内核态</div>
                        <div class="ring ring-1">Ring 1</div>
                        <div class="ring ring-2">Ring 2</div>
                        <div class="ring ring-3">Ring 3<br>用户态</div>
                    </div>
                    <p>数字越小特权级越高，Ring 0为最高特权级（内核态），Ring 3为最低特权级（用户态）</p>
                </div>
                
                <p>从硬件架构角度看，现代CPU通过特权级（Privilege Level）机制实现内核态与用户态的分离。以x86架构为例，处理器支持4个特权级，分别是Ring 0到Ring 3。</p>
                
                <h3>1.2 特权级保护机制的硬件实现</h3>
                <p>特权级保护机制的硬件实现是通过CPU的指令集权限控制和内存访问权限管理来完成的。</p>
                
                <table class="comparison-table">
                    <tr>
                        <th>特性</th>
                        <th>内核态</th>
                        <th>用户态</th>
                    </tr>
                    <tr>
                        <td>指令执行</td>
                        <td>可执行所有特权指令和非特权指令</td>
                        <td>仅支持非特权指令</td>
                    </tr>
                    <tr>
                        <td>内存访问</td>
                        <td>拥有全内存访问权限</td>
                        <td>仅能访问用户空间内存区域</td>
                    </tr>
                    <tr>
                        <td>硬件访问</td>
                        <td>可直接访问所有硬件设备</td>
                        <td>不能直接访问硬件</td>
                    </tr>
                </table>
                
                <h3>1.3 两种状态的工作环境差异</h3>
                <p>内核态与用户态在工作环境上存在显著差异，这些差异体现在内存布局、寄存器使用、中断处理、系统调用等多个方面。</p>
                
                <div class="permission-levels">
                    <div class="permission-level kernel-mode">
                        <h4>内核态工作环境</h4>
                        <ul>
                            <li>访问全部内存空间</li>
                            <li>处理所有中断</li>
                            <li>执行特权指令</li>
                            <li>直接操作硬件</li>
                        </ul>
                    </div>
                    
                    <div class="permission-level user-mode">
                        <h4>用户态工作环境</h4>
                        <ul>
                            <li>仅访问用户空间</li>
                            <li>无法处理中断</li>
                            <li>执行非特权指令</li>
                            <li>通过系统调用访问硬件</li>
                        </ul>
                    </div>
                </div>
                
                <h3>1.4 内核态与用户态的切换机制</h3>
                <p>内核态与用户态的切换是操作系统安全架构的核心机制，这种切换必须通过特定的硬件触发方式进行。</p>
                
                <p>用户态到内核态的切换由以下三类事件触发：</p>
                <ol>
                    <li><span class="highlight">系统调用</span>：用户态程序主动请求内核服务的方式</li>
                    <li><span class="highlight">硬件中断</span>：外设主动通知内核的方式</li>
                    <li><span class="highlight">异常事件</span>：错误场景下的被动切换</li>
                </ol>
                
                <p>切换过程的具体实现包括以下关键步骤：</p>
                <ol>
                    <li><strong>上下文保存</strong>：CPU将用户态寄存器状态保存到当前进程的内核栈中</li>
                    <li><strong>特权级提升</strong>：特权级别从Ring 3（用户态）提升至Ring 0（内核态）</li>
                    <li><strong>内核栈初始化</strong>：CPU将堆栈指针指向内核栈</li>
                    <li><strong>执行内核服务</strong>：根据系统调用号或中断类型，调用对应的内核函数</li>
                </ol>
            </section>
            
            <section id="section2" class="section">
                <h2>2. 操作系统权限管理体系</h2>
                
                <h3>2.1 权限管理的目标与重要性</h3>
                <p>操作系统权限管理的核心目标是确保系统资源只被合法用户以授权方式使用，实现最小权限原则。</p>
                
                <p>权限管理的重要性体现在以下几个方面：</p>
                <ul>
                    <li>保护系统资源的完整性和保密性</li>
                    <li>防范内部威胁</li>
                    <li>抵御外部攻击</li>
                    <li>确保系统的稳定性和可用性</li>
                </ul>
                
                <h3>2.2 权限管理策略与模型</h3>
                <p>操作系统权限管理采用多种策略和模型来实现不同级别的安全控制：</p>
                
                <table class="comparison-table">
                    <tr>
                        <th>模型</th>
                        <th>核心思想</th>
                        <th>特点</th>
                    </tr>
                    <tr>
                        <td>自主访问控制(DAC)</td>
                        <td>资源的所有者可以自主决定将访问权限授予其他用户</td>
                        <td>灵活，但安全性较低</td>
                    </tr>
                    <tr>
                        <td>强制访问控制(MAC)</td>
                        <td>系统根据安全策略强制决定访问权限</td>
                        <td>安全性高，但灵活性差</td>
                    </tr>
                    <tr>
                        <td>基于角色的访问控制(RBAC)</td>
                        <td>通过角色来管理权限，将权限分配给角色，再将用户分配给角色</td>
                        <td>管理简便，适合大型系统</td>
                    </tr>
                </table>
                
                <h3>2.3 主流操作系统的权限管理机制</h3>
                
                <h4>Linux权限管理机制</h4>
                <p>Linux采用基于用户和组的权限系统，每个文件都根据用户、用户组和其他设定读、写、可执行权限。</p>
                
                <div class="code-block">
# Linux权限示例
-rwxr-xr-- 1 user group 2048 Jan 1 12:00 file.txt
# 权限说明：
# 第一个字符：文件类型(-表示普通文件)
# 接下来三组：属主权限(rwx)、属组权限(r-x)、其他用户权限(r--)
# r=读(4), w=写(2), x=执行(1)
                </div>
                
                <h4>Windows权限管理机制</h4>
                <p>Windows操作系统的权限管理基于访问控制模型，该模型有两个基本部分：访问令牌和安全描述符。</p>
                
                <h3>2.4 现代操作系统的权限管理特性</h3>
                <p>现代操作系统在权限管理方面不断引入新的特性和改进：</p>
                <ul>
                    <li>细粒度权限控制的发展</li>
                    <li>动态权限管理的实现</li>
                    <li>多因素认证（MFA）的广泛应用</li>
                    <li>零信任架构的引入</li>
                    <li>AI驱动的权限管理</li>
                </ul>
            </section>
            
            <section id="section3" class="section">
                <h2>3. 用户权限管理</h2>
                
                <h3>3.1 用户权限在操作系统中的作用</h3>
                <p>用户权限在操作系统中扮演着至关重要的角色，它是实现多用户环境下资源安全访问和系统稳定运行的基础机制。</p>
                
                <p>用户权限的核心作用体现在以下几个方面：</p>
                <ul>
                    <li>实现职责分离和权限最小化</li>
                    <li>保护系统资源和数据安全</li>
                    <li>支持不同类型的访问控制需求</li>
                    <li>实现合规性要求</li>
                </ul>
                
                <h3>3.2 用户权限的类型划分与特点</h3>
                
                <h4>按操作类型分级</h4>
                <ul>
                    <li><strong>只读权限</strong>：只能查看系统中的数据、文件或资源</li>
                    <li><strong>读写权限</strong>：在查看的基础上对数据进行修改、添加新内容</li>
                    <li><strong>完全控制权限</strong>：包括查看、读写以及删除等所有操作权限</li>
                </ul>
                
                <h4>Linux系统中的用户类型</h4>
                <table class="comparison-table">
                    <tr>
                        <th>用户类型</th>
                        <th>UID范围</th>
                        <th>权限描述</th>
                    </tr>
                    <tr>
                        <td>超级用户(Root)</td>
                        <td>0</td>
                        <td>拥有系统的最高权限，可执行任何操作</td>
                    </tr>
                    <tr>
                        <td>普通用户</td>
                        <td>1000+ (CentOS)</td>
                        <td>权限受限制，仅能在自己的宿主目录和被授权的资源中操作</td>
                    </tr>
                    <tr>
                        <td>程序用户</td>
                        <td>1-999 (CentOS)</td>
                        <td>用于运行系统服务或应用程序，通常不允许登录系统</td>
                    </tr>
                </table>
                
                <h3>3.3 用户权限的设置与管理方法</h3>
                
                <h4>Linux权限管理命令</h4>
                <div class="code-block">
# 创建新用户
useradd -u 1001 -d /home/user1 -s /bin/bash user1

# 修改用户密码
passwd user1

# 创建新组
groupadd developers

# 将用户添加到组
usermod -aG developers user1

# 设置文件权限
chmod 755 script.sh  # rwxr-xr-x
chmod u+x,go-w file.txt  # 为属主添加执行权限，移除组和其他用户的写权限

# 修改文件属主和属组
chown user1:developers file.txt
                </div>
                
                <h3>3.4 用户认证与授权机制</h3>
                <p>用户认证与授权是操作系统安全体系的基础，它们共同构成了用户访问系统资源的安全屏障。</p>
                
                <p><strong>认证</strong>是验证用户身份的过程，<strong>授权</strong>是确定用户权限范围的过程。</p>
                
                <h4>多因素认证(MFA)</h4>
                <p>多因素认证要求用户提供两个或更多的验证因素来证实他们的身份：</p>
                <ol>
                    <li><strong>知识因素</strong>：如密码或PIN码</li>
                    <li><strong>持有因素</strong>：如手机或安全令牌</li>
                    <li><strong>生物因素</strong>：如指纹、面部识别</li>
                </ol>
            </section>
            
            <section id="section4" class="section">
                <h2>4. 实际应用与案例分析</h2>
                
                <h3>4.1 典型权限管理机制案例</h3>
                
                <h4>Linux的sudo机制</h4>
                <p>sudo允许普通用户临时获得root权限来执行特定的系统管理命令。</p>
                
                <div class="code-block">
# sudo配置示例
# /etc/sudoers 文件内容
user1 ALL=(ALL:ALL) ALL  # user1可以在所有主机上以任何用户和组执行任何命令
%developers ALL=(ALL) /usr/bin/systemctl restart nginx  # developers组可以重启nginx服务
                </div>
                
                <h4>SELinux安全模块</h4>
                <p>SELinux提供了比传统UNIX权限更细粒度的访问控制，默认策略是拒绝，如果不存在允许访问的SELinux策略规则则拒绝访问。</p>
                
                <h4>Windows用户账户控制(UAC)</h4>
                <p>UAC是Windows设计用于保护操作系统免受未授权更改的安全功能。当系统更改需要管理员级别权限时，UAC会通知用户，给用户批准或拒绝更改的机会。</p>
                
                <h3>4.2 系统安全加固与权限优化</h3>
                
                <h4>Linux系统安全加固措施</h4>
                <div class="code-block">
# 设置umask为077，确保新建文件默认仅属主可读写
umask 077

# 配置敏感文件权限
chmod 640 /etc/shadow
chown root:shadow /etc/shadow

# 禁用敏感目录的group/other执行权
chmod 700 /etc/ssh

# 禁用root通过SSH直接登录
# 在/etc/ssh/sshd_config中设置
PermitRootLogin no

# 启用SELinux
setenforce 1
# 修改/etc/selinux/config永久生效
SELINUX=enforcing
                </div>
                
                <h3>4.3 权限审计与监控体系</h3>
                <p>权限审计与监控体系是操作系统安全管理的重要组成部分，通过建立完善的审计机制来发现和应对安全威胁。</p>
                
                <h4>Linux审计规则配置示例</h4>
                <div class="code-block">
# /etc/audit/rules.d/privileged.rules 内容示例
-w /etc/shadow -p wa -k identity
-w /etc/passwd -p wa -k identity
-w /root/.ssh/ -p wa -k ssh_root
-w /home/*/.ssh/ -p wa -k ssh_user
-w /etc/ssl/private/ -p wa -k ssl_private
                </div>
                
                <h3>4.4 权限漏洞防范与修复</h3>
                <p>权限漏洞是操作系统安全的重大威胁，攻击者可以利用这些漏洞获得未授权的访问权限或提升其权限级别。</p>
                
                <h4>权限提升漏洞类型</h4>
                <ul>
                    <li><strong>纵向提权</strong>：利用系统漏洞将权限提升至管理员或root</li>
                    <li><strong>横向移动</strong>：借助Pass-the-Hash等工具扩散权限</li>
                </ul>
                
                <h4>权限漏洞防范措施</h4>
                <ul>
                    <li>遵循最小权限原则</li>
                    <li>定期更新和打补丁</li>
                    <li>实施权限审计和监控</li>
                    <li>使用应用程序白名单</li>
                </ul>
            </section>
            
            <section id="section5" class="section">
                <h2>5. 总结与展望</h2>
                
                <h3>5.1 核心概念回顾</h3>
                <div class="summary-box">
                    <p>CPU内核态与用户态是现代操作系统安全架构的基础。内核态运行在最高特权级别，具有完全的系统访问权限；用户态运行在最低特权级别，只能执行受限的指令集，访问权限受到严格限制。</p>
                    <p>特权级保护机制通过硬件层面的指令集权限控制和内存访问权限管理来实现。内核态与用户态的切换必须通过特定的硬件触发方式进行，包括系统调用、硬件中断和异常事件。</p>
                    <p>操作系统权限管理采用多种策略和模型来实现不同级别的安全控制，包括自主访问控制(DAC)、强制访问控制(MAC)和基于角色的访问控制(RBAC)。</p>
                </div>
                
                <h3>5.2 技术发展趋势</h3>
                <p>随着计算机技术的不断发展和安全威胁的日益复杂，操作系统权限管理技术也在不断演进和发展：</p>
                
                <ul>
                    <li><strong>零信任架构</strong>：成为权限管理的重要发展方向</li>
                    <li><strong>AI驱动的智能权限管理</strong>：用于异常检测、信任评分和策略生成</li>
                    <li><strong>云原生权限管理</strong>：支持容器化应用的权限隔离、微服务间的访问控制</li>
                    <li><strong>细粒度访问控制技术</strong>：不断发展，如URL级别的权限控制</li>
                </ul>
                
                <h3>5.3 实践建议与最佳实践</h3>
                <p>基于对CPU内核态与用户态及操作系统权限管理的深入分析，我们可以总结出以下实践建议与最佳实践：</p>
                
                <h4>权限管理策略方面</h4>
                <ul>
                    <li>始终遵循最小权限原则（Principle of Least Privilege）</li>
                    <li>定期审核权限分配，确保权限设置符合当前业务需求</li>
                    <li>对于特权账户，实施更严格的管理措施</li>
                </ul>
                
                <h4>技术实施方面</h4>
                <ul>
                    <li>采用多层次的安全防护体系</li>
                    <li>在Linux系统中启用SELinux或AppArmor等强制访问控制机制</li>
                    <li>在Windows系统中合理配置UAC机制</li>
                </ul>
                
                <h4>系统加固最佳实践</h4>
                <div class="code-block">
# Linux系统加固关键措施
1. 设置umask 077
2. 禁用敏感目录的group/other执行权限
3. 配置/etc/shadow文件权限为640，属主为root，属组为shadow
4. 禁用不必要的系统服务
5. 配置SSH禁用root直接登录，使用密钥认证
6. 启用SELinux或AppArmor
7. 配置auditd审计系统
                </div>
            </section>
        </main>
    </div>
    
    <footer>
        <p>© 2023 操作系统安全架构与权限管理 | 内容基于CPU内核态与用户态及操作系统权限管理知识总结</p>
        <p>本页面为静态HTML页面，无外部依赖，适合学习和参考使用</p>
    </footer>
    
    <script>
        // 简单的导航高亮功能
        document.addEventListener('DOMContentLoaded', function() {
            const navLinks = document.querySelectorAll('.nav-list a');
            const sections = document.querySelectorAll('.section');
            
            // 移除所有active类
            function removeActiveClasses() {
                navLinks.forEach(link => {
                    link.classList.remove('active');
                });
            }
            
            // 根据滚动位置高亮对应导航项
            function highlightNavOnScroll() {
                let currentSectionId = '';
                
                sections.forEach(section => {
                    const sectionTop = section.offsetTop - 100;
                    const sectionHeight = section.clientHeight;
                    const scrollPosition = window.pageYOffset;
                    
                    if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
                        currentSectionId = section.id;
                    }
                });
                
                removeActiveClasses();
                
                if (currentSectionId) {
                    const currentLink = document.querySelector(`.nav-list a[href="#${currentSectionId}"]`);
                    if (currentLink) {
                        currentLink.classList.add('active');
                    }
                }
            }
            
            // 点击导航项滚动到对应部分
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    const targetSection = document.querySelector(targetId);
                    
                    if (targetSection) {
                        window.scrollTo({
                            top: targetSection.offsetTop - 80,
                            behavior: 'smooth'
                        });
                    }
                });
            });
            
            // 监听滚动事件
            window.addEventListener('scroll', highlightNavOnScroll);
            
            // 初始高亮
            highlightNavOnScroll();
        });
    </script>
</body>
</html>